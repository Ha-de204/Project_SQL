create database data_bank;
use data_bank;

create table regions (
     region_id int not null,
	 region_name varchar(9) not null,
)

INSERT INTO regions
  (region_id, region_name)
VALUES
  (1, 'Australia'),
  (2, 'America'),
  (3, 'Africa'),
  (4, 'Asia'),
  (5, 'Europe');


create table customer_nodes (
     customer_id int not null,
	 region_id int not null,
	 node_id int,
	 start_date date,
	 end_date date,
)


INSERT INTO customer_nodes
  (customer_id, region_id, node_id, start_date, end_date)
VALUES
  (147, 1, 5, '2020-05-22', '9999-12-31'),
  (148, 4, 4, '2020-03-16', '9999-12-31'),
  (149, 1, 1, '2020-04-13', '9999-12-31'),
  (150, 2, 5, '2020-04-22', '9999-12-31'),
  (151, 1, 1, '2020-04-26', '9999-12-31'),
  (152, 4, 4, '2020-03-28', '9999-12-31'),
  (153, 3, 2, '2020-05-06', '9999-12-31'),
  (154, 2, 2, '2020-04-28', '9999-12-31'),
  (155, 4, 3, '2020-05-13', '9999-12-31'),
  (156, 5, 5, '2020-04-18', '9999-12-31'),
  (157, 2, 1, '2020-04-06', '9999-12-31'),
  (158, 5, 3, '2020-03-20', '9999-12-31'),
  (159, 5, 1, '2020-05-01', '9999-12-31'),
  (160, 4, 4, '2020-04-17', '9999-12-31'),
  (161, 1, 3, '2020-03-17', '9999-12-31'),
  (162, 2, 1, '2020-04-01', '9999-12-31'),
  (163, 4, 1, '2020-03-02', '9999-12-31'),
  (164, 3, 1, '2020-04-16', '9999-12-31'),
  (165, 4, 1, '2020-04-06', '9999-12-31'),
  (166, 2, 3, '2020-05-31', '9999-12-31'),
  (167, 4, 3, '2020-04-25', '9999-12-31'),
  (168, 5, 5, '2020-05-31', '9999-12-31'),
  (169, 1, 3, '2020-04-29', '9999-12-31'),
  (170, 5, 2, '2020-03-13', '9999-12-31'),
  (171, 1, 3, '2020-05-12', '9999-12-31'),
  (172, 2, 1, '2020-05-14', '9999-12-31'),
  (173, 5, 1, '2020-04-28', '9999-12-31'),
  (174, 4, 4, '2020-05-07', '9999-12-31'),
  (175, 1, 5, '2020-05-28', '9999-12-31'),
  (176, 2, 1, '2020-05-23', '9999-12-31'),
  (177, 3, 1, '2020-03-28', '9999-12-31'),
  (178, 1, 3, '2020-07-03', '9999-12-31'),
  (179, 4, 4, '2020-04-28', '9999-12-31'),
  (180, 1, 2, '2020-02-28', '9999-12-31'),
  (181, 4, 5, '2020-05-22', '9999-12-31'),
  (182, 3, 4, '2020-04-18', '9999-12-31'),
  (183, 2, 1, '2020-05-13', '9999-12-31'),
  (184, 2, 3, '2020-04-18', '9999-12-31'),
  (185, 5, 1, '2020-05-13', '9999-12-31'),
  (186, 2, 2, '2020-04-17', '9999-12-31'),
  (187, 1, 5, '2020-04-23', '9999-12-31'),
  (188, 1, 3, '2020-04-08', '9999-12-31'),
  (189, 4, 3, '2020-02-24', '9999-12-31'),
  (190, 5, 1, '2020-04-24', '9999-12-31'),
  (191, 5, 5, '2020-04-23', '9999-12-31'),
  (192, 5, 2, '2020-04-29', '9999-12-31'),
  (193, 5, 3, '2020-04-20', '9999-12-31'),
  (194, 4, 5, '2020-05-23', '9999-12-31'),
  (195, 4, 3, '2020-04-16', '9999-12-31'),
  (196, 5, 5, '2020-04-17', '9999-12-31'),
  (197, 2, 1, '2020-04-29', '9999-12-31'),
  (198, 3, 1, '2020-04-16', '9999-12-31'),
  (199, 2, 3, '2020-04-11', '9999-12-31'),
  (200, 1, 5, '2020-05-14', '9999-12-31'),
  (201, 4, 3, '2020-03-14', '9999-12-31'),
  (202, 2, 2, '2020-04-14', '9999-12-31'),
  (203, 5, 5, '2020-05-01', '9999-12-31'),
  (204, 1, 4, '2020-04-22', '9999-12-31'),
  (205, 2, 3, '2020-03-15', '9999-12-31'),
  (206, 2, 3, '2020-03-11', '9999-12-31'),
  (207, 4, 3, '2020-03-28', '9999-12-31'),
  (208, 2, 3, '2020-04-11', '9999-12-31'),
  (209, 4, 4, '2020-03-29', '9999-12-31'),
  (210, 5, 2, '2020-03-23', '9999-12-31'),
  (211, 1, 4, '2020-05-06', '9999-12-31'),
  (212, 2, 5, '2020-04-18', '9999-12-31'),
  (213, 3, 5, '2020-04-06', '9999-12-31'),
  (214, 2, 1, '2020-03-09', '9999-12-31'),
  (215, 2, 2, '2020-05-06', '9999-12-31'),
  (216, 3, 1, '2020-04-17', '9999-12-31'),
  (217, 1, 2, '2020-04-10', '9999-12-31'),
  (218, 5, 5, '2020-05-10', '9999-12-31'),
  (219, 2, 3, '2020-04-14', '9999-12-31'),
  (220, 2, 1, '2020-05-29', '9999-12-31'),
  (221, 4, 5, '2020-04-25', '9999-12-31'),
  (222, 1, 2, '2020-04-09', '9999-12-31'),
  (223, 4, 1, '2020-05-04', '9999-12-31'),
  (224, 2, 4, '2020-05-01', '9999-12-31'),
  (225, 3, 4, '2020-05-28', '9999-12-31'),
  (226, 2, 2, '2020-04-19', '9999-12-31'),
  (227, 1, 4, '2020-03-30', '9999-12-31'),
  (228, 4, 5, '2020-04-27', '9999-12-31'),
  (229, 5, 1, '2020-04-08', '9999-12-31'),
  (230, 3, 3, '2020-04-28', '9999-12-31'),
  (231, 3, 1, '2020-04-14', '9999-12-31'),
  (232, 4, 1, '2020-04-03', '9999-12-31'),
  (233, 2, 3, '2020-04-09', '9999-12-31'),
  (234, 2, 1, '2020-04-02', '9999-12-31'),
  (235, 1, 1, '2020-04-28', '9999-12-31'),
  (236, 4, 5, '2020-04-28', '9999-12-31'),
  (237, 1, 4, '2020-03-14', '9999-12-31'),
  (238, 4, 5, '2020-03-26', '9999-12-31'),
  (239, 4, 5, '2020-04-05', '9999-12-31'),
  (240, 2, 1, '2020-04-26', '9999-12-31'),
  (241, 4, 1, '2020-04-07', '9999-12-31'),
  (242, 3, 2, '2020-03-26', '9999-12-31'),
  (243, 1, 1, '2020-02-24', '9999-12-31'),
  (244, 1, 1, '2020-04-11', '9999-12-31'),
  (245, 3, 3, '2020-04-22', '9999-12-31'),
  (246, 1, 2, '2020-04-29', '9999-12-31'),
  (247, 3, 2, '2020-03-24', '9999-12-31'),
  (248, 4, 1, '2020-04-10', '9999-12-31'),
  (249, 5, 3, '2020-04-28', '9999-12-31'),
  (250, 3, 3, '2020-03-22', '9999-12-31'),
  (251, 2, 1, '2020-04-08', '9999-12-31'),
  (252, 4, 2, '2020-04-24', '9999-12-31'),
  (253, 4, 1, '2020-06-11', '9999-12-31'),
  (254, 1, 4, '2020-02-29', '9999-12-31'),
  (255, 4, 2, '2020-05-10', '9999-12-31'),
  (256, 3, 4, '2020-04-28', '9999-12-31'),
  (257, 5, 3, '2020-06-02', '9999-12-31'),
  (258, 1, 4, '2020-05-07', '9999-12-31'),
  (259, 2, 5, '2020-04-18', '9999-12-31'),
  (260, 4, 2, '2020-05-20', '9999-12-31'),
  (261, 2, 2, '2020-05-19', '9999-12-31'),
  (262, 3, 4, '2020-04-10', '9999-12-31'),
  (263, 2, 5, '2020-04-05', '9999-12-31'),
  (264, 4, 3, '2020-04-10', '9999-12-31'),
  (265, 1, 4, '2020-03-29', '9999-12-31'),
  (266, 3, 4, '2020-05-21', '9999-12-31'),
  (267, 3, 5, '2020-04-16', '9999-12-31'),
  (268, 4, 4, '2020-03-21', '9999-12-31'),
  (269, 5, 3, '2020-04-12', '9999-12-31'),
  (270, 4, 1, '2020-04-10', '9999-12-31'),
  (271, 3, 3, '2020-03-25', '9999-12-31'),
  (272, 2, 1, '2020-02-17', '9999-12-31'),
  (273, 2, 1, '2020-04-12', '9999-12-31'),
  (274, 1, 1, '2020-04-23', '9999-12-31'),
  (275, 2, 2, '2020-03-29', '9999-12-31'),
  (276, 1, 2, '2020-04-07', '9999-12-31'),
  (277, 1, 2, '2020-05-14', '9999-12-31'),
  (278, 1, 1, '2020-04-21', '9999-12-31'),
  (279, 4, 2, '2020-04-25', '9999-12-31'),
  (280, 2, 1, '2020-03-27', '9999-12-31'),
  (281, 2, 1, '2020-04-10', '9999-12-31'),
  (282, 1, 2, '2020-05-10', '9999-12-31'),
  (283, 1, 3, '2020-04-29', '9999-12-31'),
  (284, 1, 1, '2020-06-05', '9999-12-31'),
  (285, 3, 1, '2020-05-22', '9999-12-31'),
  (286, 4, 3, '2020-04-20', '9999-12-31'),
  (287, 1, 1, '2020-05-05', '9999-12-31'),
  (288, 4, 4, '2020-03-30', '9999-12-31'),
  (289, 3, 4, '2020-05-01', '9999-12-31'),
  (290, 4, 1, '2020-03-06', '9999-12-31'),
  (291, 5, 4, '2020-05-07', '9999-12-31'),
  (292, 1, 4, '2020-05-08', '9999-12-31'),
  (293, 5, 4, '2020-04-23', '9999-12-31'),
  (294, 2, 1, '2020-04-29', '9999-12-31'),
  (295, 2, 4, '2020-03-23', '9999-12-31'),
  (296, 5, 3, '2020-03-19', '9999-12-31'),
  (297, 1, 5, '2020-04-05', '9999-12-31'),
  (298, 4, 5, '2020-05-15', '9999-12-31'),
  (299, 3, 2, '2020-05-10', '9999-12-31'),
  (300, 2, 2, '2020-06-14', '9999-12-31'),
  (301, 3, 2, '2020-04-05', '9999-12-31'),
  (302, 1, 4, '2020-06-06', '9999-12-31'),
  (303, 1, 5, '2020-04-08', '9999-12-31'),
  (304, 5, 1, '2020-05-14', '9999-12-31'),
  (305, 1, 1, '2020-05-06', '9999-12-31'),
  (306, 4, 4, '2020-04-24', '9999-12-31'),
  (307, 5, 5, '2020-04-16', '9999-12-31'),
  (308, 3, 4, '2020-03-30', '9999-12-31'),
  (309, 5, 2, '2020-03-25', '9999-12-31'),
  (310, 5, 4, '2020-05-05', '9999-12-31'),
  (311, 3, 5, '2020-03-24', '9999-12-31'),
  (312, 5, 2, '2020-04-24', '9999-12-31'),
  (313, 3, 2, '2020-05-11', '9999-12-31'),
  (314, 1, 3, '2020-05-12', '9999-12-31'),
  (315, 3, 2, '2020-03-21', '9999-12-31'),
  (316, 4, 3, '2020-05-11', '9999-12-31'),
  (317, 2, 3, '2020-04-25', '9999-12-31'),
  (318, 4, 3, '2020-05-07', '9999-12-31'),
  (319, 1, 4, '2020-04-07', '9999-12-31'),
  (320, 3, 5, '2020-05-10', '9999-12-31'),
  (321, 3, 4, '2020-05-28', '9999-12-31'),
  (322, 5, 4, '2020-03-31', '9999-12-31'),
  (323, 1, 4, '2020-04-12', '9999-12-31'),
  (324, 1, 5, '2020-04-14', '9999-12-31'),
  (325, 2, 1, '2020-05-26', '9999-12-31'),
  (326, 4, 3, '2020-04-21', '9999-12-31'),
  (327, 5, 5, '2020-03-21', '9999-12-31'),
  (328, 3, 3, '2020-03-30', '9999-12-31'),
  (329, 5, 2, '2020-05-24', '9999-12-31'),
  (330, 5, 2, '2020-04-22', '9999-12-31'),
  (331, 5, 2, '2020-04-12', '9999-12-31'),
  (332, 5, 2, '2020-05-02', '9999-12-31'),
  (333, 5, 1, '2020-04-06', '9999-12-31'),
  (334, 2, 5, '2020-05-25', '9999-12-31'),
  (335, 2, 5, '2020-03-19', '9999-12-31'),
  (336, 2, 2, '2020-04-03', '9999-12-31'),
  (337, 3, 1, '2020-05-18', '9999-12-31'),
  (338, 3, 4, '2020-04-29', '9999-12-31'),
  (339, 2, 1, '2020-03-22', '9999-12-31'),
  (340, 4, 3, '2020-03-15', '9999-12-31'),
  (341, 5, 2, '2020-05-17', '9999-12-31'),
  (342, 1, 5, '2020-04-21', '9999-12-31'),
  (343, 2, 5, '2020-04-12', '9999-12-31'),
  (344, 1, 4, '2020-04-14', '9999-12-31'),
  (345, 4, 5, '2020-04-08', '9999-12-31'),
  (346, 4, 1, '2020-05-11', '9999-12-31'),
  (347, 1, 3, '2020-04-21', '9999-12-31'),
  (348, 3, 2, '2020-04-01', '9999-12-31'),
  (349, 3, 1, '2020-05-03', '9999-12-31'),
  (350, 2, 5, '2020-04-15', '9999-12-31'),
  (351, 3, 4, '2020-03-26', '9999-12-31'),
  (352, 5, 1, '2020-04-22', '9999-12-31'),
  (353, 3, 5, '2020-04-21', '9999-12-31'),
  (354, 5, 4, '2020-05-19', '9999-12-31'),
  (355, 3, 2, '2020-05-23', '9999-12-31'),
  (356, 5, 3, '2020-04-23', '9999-12-31'),
  (357, 4, 2, '2020-05-11', '9999-12-31'),
  (358, 3, 1, '2020-04-18', '9999-12-31'),
  (359, 2, 3, '2020-04-04', '9999-12-31'),
  (360, 5, 3, '2020-02-29', '9999-12-31'),
  (361, 5, 5, '2020-05-18', '9999-12-31'),
  (362, 5, 1, '2020-04-17', '9999-12-31'),
  (363, 5, 1, '2020-04-25', '9999-12-31'),
  (364, 4, 3, '2020-05-02', '9999-12-31'),
  (365, 2, 5, '2020-05-24', '9999-12-31'),
  (366, 2, 3, '2020-05-17', '9999-12-31'),
  (367, 3, 4, '2020-04-25', '9999-12-31'),
  (368, 1, 5, '2020-05-05', '9999-12-31'),
  (369, 4, 5, '2020-04-03', '9999-12-31'),
  (370, 5, 2, '2020-05-22', '9999-12-31'),
  (371, 5, 4, '2020-05-31', '9999-12-31'),
  (372, 2, 4, '2020-04-12', '9999-12-31'),
  (373, 5, 2, '2020-05-10', '9999-12-31'),
  (374, 2, 4, '2020-03-12', '9999-12-31'),
  (375, 1, 1, '2020-04-02', '9999-12-31'),
  (376, 5, 1, '2020-04-16', '9999-12-31'),
  (377, 4, 5, '2020-04-26', '9999-12-31'),
  (378, 2, 2, '2020-04-03', '9999-12-31'),
  (379, 5, 3, '2020-04-23', '9999-12-31'),
  (380, 1, 4, '2020-04-26', '9999-12-31'),
  (381, 1, 3, '2020-04-15', '9999-12-31'),
  (382, 4, 4, '2020-03-09', '9999-12-31'),
  (383, 2, 5, '2020-05-16', '9999-12-31'),
  (384, 3, 4, '2020-05-14', '9999-12-31'),
  (385, 2, 5, '2020-05-13', '9999-12-31'),
  (386, 1, 3, '2020-05-30', '9999-12-31'),
  (387, 1, 5, '2020-03-22', '9999-12-31'),
  (388, 3, 3, '2020-04-19', '9999-12-31'),
  (389, 4, 2, '2020-04-01', '9999-12-31'),
  (390, 2, 1, '2020-03-22', '9999-12-31'),
  (391, 3, 2, '2020-04-20', '9999-12-31'),
  (392, 2, 3, '2020-03-24', '9999-12-31'),
  (393, 2, 4, '2020-04-04', '9999-12-31'),
  (394, 4, 5, '2020-05-13', '9999-12-31'),
  (395, 1, 2, '2020-04-15', '9999-12-31'),
  (396, 3, 1, '2020-05-02', '9999-12-31'),
  (397, 4, 3, '2020-04-26', '9999-12-31'),
  (398, 3, 3, '2020-04-11', '9999-12-31'),
  (399, 3, 1, '2020-04-03', '9999-12-31'),
  (400, 4, 1, '2020-03-29', '9999-12-31'),
  (401, 1, 1, '2020-02-19', '9999-12-31'),
  (402, 2, 5, '2020-04-20', '9999-12-31'),
  (403, 3, 5, '2020-04-30', '9999-12-31'),
  (404, 5, 4, '2020-02-05', '9999-12-31'),
  (405, 4, 3, '2020-03-31', '9999-12-31'),
  (406, 5, 2, '2020-04-18', '9999-12-31'),
  (407, 3, 4, '2020-04-01', '9999-12-31'),
  (408, 5, 4, '2020-04-21', '9999-12-31'),
  (409, 5, 3, '2020-05-01', '9999-12-31'),
  (410, 2, 2, '2020-04-26', '9999-12-31'),
  (411, 2, 2, '2020-06-02', '9999-12-31'),
  (412, 4, 5, '2020-03-21', '9999-12-31'),
  (413, 3, 5, '2020-04-14', '9999-12-31'),
  (414, 1, 3, '2020-03-18', '9999-12-31'),
  (415, 5, 2, '2020-04-02', '9999-12-31'),
  (416, 1, 5, '2020-04-27', '9999-12-31'),
  (417, 1, 2, '2020-02-29', '9999-12-31'),
  (418, 1, 1, '2020-03-23', '9999-12-31'),
  (419, 1, 4, '2020-03-15', '9999-12-31'),
  (420, 2, 1, '2020-05-01', '9999-12-31'),
  (421, 3, 3, '2020-04-15', '9999-12-31'),
  (422, 1, 4, '2020-05-04', '9999-12-31'),
  (423, 4, 4, '2020-04-10', '9999-12-31'),
  (424, 1, 5, '2020-04-18', '9999-12-31'),
  (425, 3, 3, '2020-04-11', '9999-12-31'),
  (426, 1, 3, '2020-05-12', '9999-12-31'),
  (427, 4, 3, '2020-05-26', '9999-12-31'),
  (428, 2, 1, '2020-05-09', '9999-12-31'),
  (429, 5, 3, '2020-04-18', '9999-12-31'),
  (430, 2, 5, '2020-04-01', '9999-12-31'),
  (431, 3, 5, '2020-04-09', '9999-12-31'),
  (432, 1, 3, '2020-03-15', '9999-12-31'),
  (433, 4, 1, '2020-04-03', '9999-12-31'),
  (434, 5, 4, '2020-04-04', '9999-12-31'),
  (435, 3, 2, '2020-04-01', '9999-12-31'),
  (436, 3, 2, '2020-04-07', '9999-12-31'),
  (437, 1, 3, '2020-04-06', '9999-12-31'),
  (438, 4, 2, '2020-04-25', '9999-12-31'),
  (439, 3, 2, '2020-04-27', '9999-12-31'),
  (440, 5, 4, '2020-03-18', '9999-12-31'),
  (441, 4, 3, '2020-04-13', '9999-12-31'),
  (442, 1, 5, '2020-05-09', '9999-12-31'),
  (443, 2, 4, '2020-04-15', '9999-12-31'),
  (444, 3, 4, '2020-03-19', '9999-12-31'),
  (445, 2, 3, '2020-04-30', '9999-12-31'),
  (446, 3, 3, '2020-05-14', '9999-12-31'),
  (447, 5, 1, '2020-04-02', '9999-12-31'),
  (448, 3, 5, '2020-05-20', '9999-12-31'),
  (449, 3, 5, '2020-04-11', '9999-12-31'),
  (450, 3, 5, '2020-05-05', '9999-12-31'),
  (451, 1, 3, '2020-04-26', '9999-12-31'),
  (452, 2, 1, '2020-03-19', '9999-12-31'),
  (453, 1, 5, '2020-04-12', '9999-12-31'),
  (454, 2, 3, '2020-05-22', '9999-12-31'),
  (455, 1, 2, '2020-03-17', '9999-12-31'),
  (456, 2, 3, '2020-04-03', '9999-12-31'),
  (457, 1, 3, '2020-05-02', '9999-12-31'),
  (458, 4, 1, '2020-03-15', '9999-12-31'),
  (459, 3, 2, '2020-04-19', '9999-12-31'),
  (460, 3, 4, '2020-03-25', '9999-12-31'),
  (461, 1, 2, '2020-04-02', '9999-12-31'),
  (462, 1, 2, '2020-04-22', '9999-12-31'),
  (463, 4, 2, '2020-05-14', '9999-12-31'),
  (464, 1, 3, '2020-04-21', '9999-12-31'),
  (465, 4, 2, '2020-03-27', '9999-12-31'),
  (466, 1, 4, '2020-03-29', '9999-12-31'),
  (467, 3, 2, '2020-03-28', '9999-12-31'),
  (468, 4, 1, '2020-04-09', '9999-12-31'),
  (469, 2, 4, '2020-04-24', '9999-12-31'),
  (470, 3, 5, '2020-04-12', '9999-12-31'),
  (471, 2, 1, '2020-04-17', '9999-12-31'),
  (472, 4, 4, '2020-05-02', '9999-12-31'),
  (473, 5, 4, '2020-04-26', '9999-12-31'),
  (474, 3, 3, '2020-04-17', '9999-12-31'),
  (475, 2, 5, '2020-03-22', '9999-12-31'),
  (476, 3, 2, '2020-04-23', '9999-12-31'),
  (477, 3, 2, '2020-04-19', '9999-12-31'),
  (478, 3, 5, '2020-03-31', '9999-12-31'),
  (479, 3, 5, '2020-04-08', '9999-12-31'),
  (480, 2, 2, '2020-04-24', '9999-12-31'),
  (481, 1, 4, '2020-04-23', '9999-12-31'),
  (482, 3, 1, '2020-04-26', '9999-12-31'),
  (483, 5, 2, '2020-04-10', '9999-12-31'),
  (484, 3, 1, '2020-05-07', '9999-12-31'),
  (485, 2, 2, '2020-04-17', '9999-12-31'),
  (486, 3, 1, '2020-03-31', '9999-12-31'),
  (487, 3, 5, '2020-04-01', '9999-12-31'),
  (488, 5, 3, '2020-04-13', '9999-12-31'),
  (489, 4, 5, '2020-03-25', '9999-12-31'),
  (490, 5, 3, '2020-03-28', '9999-12-31'),
  (491, 3, 5, '2020-05-13', '9999-12-31'),
  (492, 1, 4, '2020-05-06', '9999-12-31'),
  (493, 4, 3, '2020-03-19', '9999-12-31'),
  (494, 5, 5, '2020-04-14', '9999-12-31'),
  (495, 5, 4, '2020-05-07', '9999-12-31'),
  (496, 3, 4, '2020-02-25', '9999-12-31'),
  (497, 5, 4, '2020-05-27', '9999-12-31'),
  (498, 1, 2, '2020-04-05', '9999-12-31'),
  (499, 5, 1, '2020-02-03', '9999-12-31'),
  (500, 2, 2, '2020-04-15', '9999-12-31');



create table customer_transactions (
     customer_id int not null,
	 txn_date date,
	 txn_type varchar(10),
	 txn_amount int,
)

INSERT INTO customer_transactions
  (customer_id, txn_date, txn_type, txn_amount)
VALUES
  (38, '2020-03-26', 'purchase', 235),
  (38, '2020-04-07', 'deposit', 759),
  (38, '2020-01-21', 'purchase', 28),
  (38, '2020-03-25', 'purchase', 628),
  (38, '2020-03-16', 'deposit', 410),
  (38, '2020-02-14', 'deposit', 83),
  (38, '2020-03-22', 'deposit', 724),
  (38, '2020-04-11', 'deposit', 152),
  (38, '2020-03-18', 'deposit', 354),
  (38, '2020-03-04', 'purchase', 788),
  (38, '2020-03-18', 'purchase', 128),
  (38, '2020-02-11', 'deposit', 475),
  (38, '2020-04-19', 'purchase', 950),
  (38, '2020-03-07', 'purchase', 42),
  (38, '2020-02-14', 'purchase', 894),
  (38, '2020-01-30', 'deposit', 728),
  (107, '2020-01-16', 'purchase', 682),
  (107, '2020-02-17', 'withdrawal', 546),
  (183, '2020-03-07', 'purchase', 862),
  (183, '2020-04-01', 'deposit', 706),
  (183, '2020-03-23', 'withdrawal', 352),
  (183, '2020-02-28', 'withdrawal', 858),
  (183, '2020-02-13', 'withdrawal', 983),
  (183, '2020-03-09', 'withdrawal', 275),
  (183, '2020-04-15', 'withdrawal', 596),
  (183, '2020-04-01', 'withdrawal', 22),
  (183, '2020-03-07', 'purchase', 181),
  (183, '2020-04-10', 'deposit', 173),
  (183, '2020-01-28', 'purchase', 392),
  (183, '2020-01-31', 'withdrawal', 992),
  (183, '2020-02-09', 'withdrawal', 435),
  (183, '2020-01-29', 'deposit', 743),
  (183, '2020-03-18', 'withdrawal', 684),
  (183, '2020-04-11', 'withdrawal', 738),
  (183, '2020-02-12', 'purchase', 876),
  (183, '2020-02-09', 'purchase', 37),
  (397, '2020-02-05', 'deposit', 133),
  (397, '2020-03-11', 'purchase', 73),
  (397, '2020-03-10', 'deposit', 676),
  (102, '2020-03-26', 'withdrawal', 584),
  (102, '2020-03-18', 'deposit', 984),
  (102, '2020-02-16', 'deposit', 562),
  (102, '2020-03-09', 'purchase', 772),
  (102, '2020-02-06', 'deposit', 438),
  (102, '2020-04-08', 'withdrawal', 507),
  (102, '2020-04-06', 'withdrawal', 468),
  (102, '2020-02-12', 'purchase', 243),
  (102, '2020-03-15', 'withdrawal', 329),
  (102, '2020-02-11', 'purchase', 926),
  (102, '2020-04-15', 'deposit', 516),
  (102, '2020-04-18', 'withdrawal', 31),
  (102, '2020-03-14', 'withdrawal', 395),
  (102, '2020-03-18', 'deposit', 639),
  (102, '2020-03-10', 'deposit', 591),
  (102, '2020-03-09', 'deposit', 303),
  (102, '2020-02-17', 'purchase', 265),
  (102, '2020-02-21', 'deposit', 945),
  (102, '2020-04-02', 'deposit', 192),
  (102, '2020-04-17', 'withdrawal', 921),
  (182, '2020-03-16', 'withdrawal', 798),
  (182, '2020-02-23', 'deposit', 447),
  (182, '2020-02-25', 'deposit', 600),
  (182, '2020-02-04', 'purchase', 868),
  (182, '2020-04-01', 'withdrawal', 239),
  (182, '2020-02-24', 'withdrawal', 321),
  (182, '2020-04-05', 'deposit', 923),
  (141, '2020-04-04', 'deposit', 425),
  (141, '2020-02-29', 'deposit', 384),
  (141, '2020-01-20', 'purchase', 320),
  (141, '2020-03-19', 'deposit', 630),
  (141, '2020-01-22', 'purchase', 983),
  (141, '2020-02-03', 'deposit', 588),
  (141, '2020-02-06', 'deposit', 50),
  (141, '2020-02-28', 'deposit', 830),
  (494, '2020-02-03', 'withdrawal', 286),
  (494, '2020-02-13', 'deposit', 666),
  (494, '2020-03-12', 'deposit', 538),
  (252, '2020-01-28', 'purchase', 693),
  (252, '2020-04-24', 'withdrawal', 156),
  (297, '2020-02-20', 'purchase', 741),
  (297, '2020-01-26', 'deposit', 973),
  (297, '2020-02-28', 'withdrawal', 113),
  (297, '2020-02-17', 'withdrawal', 151),
  (297, '2020-03-30', 'deposit', 514),
  (297, '2020-03-22', 'purchase', 377),
  (297, '2020-04-17', 'deposit', 278),
  (297, '2020-01-29', 'purchase', 53),
  (297, '2020-03-07', 'deposit', 822),
  (297, '2020-03-20', 'purchase', 391),
  (297, '2020-02-02', 'deposit', 809),
  (297, '2020-03-14', 'purchase', 149),
  (297, '2020-01-30', 'withdrawal', 886),
  (297, '2020-02-18', 'withdrawal', 382),
  (297, '2020-01-30', 'deposit', 47),
  (297, '2020-02-21', 'deposit', 613),
  (431, '2020-02-20', 'purchase', 739),
  (431, '2020-01-18', 'deposit', 158),
  (431, '2020-01-20', 'purchase', 659),
  (324, '2020-03-29', 'deposit', 987),
  (324, '2020-01-28', 'purchase', 818),
  (324, '2020-01-04', 'deposit', 483),
  (324, '2020-02-09', 'deposit', 764),
  (324, '2020-03-29', 'withdrawal', 669),
  (324, '2020-03-22', 'deposit', 185),
  (6, '2020-01-14', 'purchase', 40),
  (6, '2020-03-16', 'deposit', 535),
  (6, '2020-02-27', 'deposit', 106),
  (6, '2020-03-23', 'purchase', 968),
  (6, '2020-02-24', 'deposit', 240),
  (6, '2020-01-25', 'deposit', 796),
  (6, '2020-03-01', 'withdrawal', 500),
  (6, '2020-01-18', 'purchase', 66),
  (6, '2020-03-31', 'withdrawal', 405),
  (6, '2020-03-15', 'deposit', 763),
  (6, '2020-01-28', 'purchase', 777),
  (6, '2020-01-14', 'purchase', 11),
  (6, '2020-03-03', 'deposit', 582),
  (6, '2020-03-26', 'withdrawal', 484),
  (6, '2020-03-04', 'deposit', 250),
  (6, '2020-02-27', 'withdrawal', 169),
  (6, '2020-02-10', 'purchase', 962),
  (6, '2020-03-10', 'deposit', 619),
  (262, '2020-03-11', 'deposit', 264),
  (262, '2020-02-18', 'withdrawal', 584),
  (262, '2020-03-23', 'purchase', 871),
  (262, '2020-01-23', 'purchase', 57),
  (262, '2020-03-19', 'deposit', 646),
  (262, '2020-03-24', 'purchase', 28),
  (262, '2020-03-07', 'withdrawal', 516),
  (262, '2020-03-25', 'deposit', 155),
  (262, '2020-03-20', 'deposit', 610),
  (262, '2020-01-11', 'withdrawal', 368),
  (262, '2020-02-15', 'purchase', 702),
  (262, '2020-02-16', 'purchase', 227),
  (262, '2020-03-06', 'deposit', 97),
  (262, '2020-03-31', 'withdrawal', 130),
  (262, '2020-02-17', 'purchase', 16),
  (262, '2020-01-04', 'withdrawal', 728),
  (341, '2020-03-19', 'withdrawal', 958),
  (341, '2020-04-18', 'withdrawal', 168),
  (341, '2020-03-10', 'withdrawal', 310),
  (341, '2020-03-30', 'deposit', 8),
  (341, '2020-02-26', 'withdrawal', 576),
  (341, '2020-04-24', 'deposit', 207),
  (341, '2020-02-12', 'deposit', 77),
  (341, '2020-02-27', 'purchase', 719),
  (121, '2020-03-06', 'withdrawal', 869),
  (121, '2020-03-15', 'purchase', 878),
  (121, '2020-02-15', 'purchase', 711),
  (121, '2020-02-20', 'purchase', 543),
  (121, '2020-01-20', 'deposit', 19),
  (121, '2020-03-11', 'deposit', 26),
  (121, '2020-02-29', 'deposit', 230),
  (121, '2020-02-04', 'deposit', 328),
  (121, '2020-01-28', 'deposit', 774),
  (121, '2020-01-22', 'deposit', 864),
  (27, '2020-02-25', 'deposit', 692),
  (27, '2020-01-16', 'withdrawal', 263),
  (27, '2020-03-16', 'deposit', 521),
  (27, '2020-03-11', 'withdrawal', 992),
  (27, '2020-01-05', 'deposit', 161),
  (27, '2020-03-03', 'purchase', 769),
  (27, '2020-02-28', 'deposit', 911),
  (27, '2020-01-08', 'deposit', 134),
  (27, '2020-03-13', 'deposit', 71),
  (27, '2020-02-07', 'deposit', 734),
  (27, '2020-02-02', 'withdrawal', 666),
  (27, '2020-02-14', 'withdrawal', 690),
  (27, '2020-03-12', 'purchase', 175),
  (27, '2020-01-02', 'withdrawal', 604),
  (27, '2020-01-25', 'withdrawal', 583),
  (27, '2020-03-25', 'purchase', 569),
  (27, '2020-02-16', 'purchase', 505),
  (27, '2020-01-21', 'purchase', 843),
  (27, '2020-03-14', 'purchase', 490),
  (248, '2020-04-05', 'deposit', 844),
  (248, '2020-02-10', 'withdrawal', 617),
  (248, '2020-03-04', 'purchase', 938),
  (248, '2020-04-19', 'deposit', 175),
  (248, '2020-02-04', 'deposit', 980),
  (248, '2020-04-08', 'withdrawal', 620),
  (248, '2020-04-10', 'withdrawal', 166),
  (248, '2020-03-26', 'deposit', 572),
  (248, '2020-03-13', 'deposit', 654),
  (489, '2020-04-05', 'withdrawal', 31),
  (489, '2020-03-09', 'deposit', 912),
  (489, '2020-03-26', 'purchase', 527),
  (489, '2020-03-23', 'purchase', 63),
  (489, '2020-04-11', 'withdrawal', 114),
  (489, '2020-02-16', 'purchase', 603),
  (489, '2020-04-11', 'purchase', 66),
  (489, '2020-02-10', 'deposit', 545),
  (489, '2020-02-28', 'deposit', 540),
  (489, '2020-04-12', 'deposit', 185),
  (489, '2020-02-17', 'deposit', 770),
  (489, '2020-03-28', 'deposit', 231),
  (489, '2020-04-12', 'deposit', 523),
  (489, '2020-04-10', 'deposit', 826),
  (489, '2020-04-09', 'deposit', 673),
  (489, '2020-03-10', 'deposit', 981),
  (445, '2020-04-20', 'deposit', 477),
  (445, '2020-04-17', 'deposit', 663),
  (445, '2020-02-07', 'purchase', 982),
  (445, '2020-02-12', 'withdrawal', 374),
  (445, '2020-04-17', 'withdrawal', 371),
  (445, '2020-01-25', 'deposit', 832),
  (445, '2020-04-22', 'withdrawal', 483),
  (445, '2020-01-29', 'deposit', 331),
  (445, '2020-03-11', 'withdrawal', 454),
  (445, '2020-02-06', 'deposit', 471),
  (445, '2020-04-01', 'withdrawal', 395),
  (445, '2020-03-05', 'deposit', 428),
  (445, '2020-01-26', 'purchase', 635),
  (445, '2020-03-05', 'withdrawal', 144),
  (445, '2020-02-17', 'deposit', 415),
  (445, '2020-04-06', 'purchase', 303),
  (145, '2020-01-19', 'purchase', 112),
  (145, '2020-02-23', 'deposit', 724),
  (145, '2020-02-15', 'purchase', 980),
  (145, '2020-02-19', 'deposit', 753),
  (145, '2020-03-02', 'withdrawal', 776),
  (145, '2020-01-07', 'withdrawal', 6),
  (145, '2020-01-07', 'purchase', 585),
  (145, '2020-02-11', 'withdrawal', 283),
  (145, '2020-01-27', 'withdrawal', 996),
  (145, '2020-01-13', 'withdrawal', 373),
  (145, '2020-03-12', 'purchase', 998),
  (145, '2020-03-03', 'purchase', 890),
  (145, '2020-01-08', 'purchase', 972),
  (145, '2020-01-06', 'withdrawal', 372),
  (145, '2020-03-24', 'deposit', 515),
  (145, '2020-02-01', 'withdrawal', 54),
  (145, '2020-02-15', 'deposit', 921),
  (43, '2020-02-14', 'withdrawal', 96),
  (43, '2020-03-27', 'deposit', 716),
  (43, '2020-03-18', 'withdrawal', 412),
  (43, '2020-02-20', 'purchase', 314),
  (43, '2020-04-07', 'purchase', 842),
  (43, '2020-02-23', 'purchase', 670),
  (43, '2020-01-31', 'withdrawal', 519),
  (43, '2020-03-08', 'deposit', 971),
  (43, '2020-04-24', 'deposit', 518),
  (43, '2020-02-09', 'deposit', 875),
  (82, '2020-03-14', 'deposit', 778),
  (82, '2020-02-04', 'purchase', 74),
  (82, '2020-01-27', 'deposit', 854),
  (82, '2020-01-28', 'withdrawal', 760),
  (82, '2020-04-03', 'purchase', 419),
  (82, '2020-03-15', 'deposit', 789),
  (82, '2020-01-15', 'purchase', 972),
  (82, '2020-01-28', 'withdrawal', 436),
  (82, '2020-01-30', 'purchase', 900),
  (82, '2020-01-26', 'purchase', 889),
  (82, '2020-04-02', 'purchase', 946),
  (82, '2020-03-10', 'withdrawal', 764),
  (82, '2020-03-06', 'withdrawal', 66),
  (82, '2020-01-16', 'withdrawal', 979),
  (82, '2020-01-18', 'withdrawal', 193),
  (315, '2020-02-08', 'deposit', 54),
  (315, '2020-03-26', 'deposit', 938),
  (315, '2020-01-22', 'deposit', 911),
  (444, '2020-03-25', 'purchase', 378),
  (444, '2020-03-09', 'deposit', 822),
  (444, '2020-02-09', 'withdrawal', 805),
  (444, '2020-03-30', 'withdrawal', 671),
  (444, '2020-02-02', 'purchase', 14),
  (444, '2020-01-11', 'purchase', 586),
  (444, '2020-03-07', 'deposit', 906),
  (444, '2020-02-10', 'withdrawal', 442),
  (444, '2020-04-08', 'withdrawal', 321),
  (48, '2020-01-14', 'purchase', 144),
  (48, '2020-03-07', 'purchase', 600),
  (48, '2020-01-23', 'withdrawal', 440),
  (48, '2020-02-16', 'purchase', 84),
  (48, '2020-01-23', 'withdrawal', 955),
  (48, '2020-01-09', 'withdrawal', 784),
  (48, '2020-02-23', 'deposit', 856),
  (48, '2020-01-29', 'deposit', 471),
  (48, '2020-01-27', 'deposit', 166),
  (48, '2020-02-05', 'purchase', 950),
  (48, '2020-03-26', 'purchase', 645),
  (48, '2020-02-29', 'withdrawal', 189),
  (48, '2020-02-17', 'withdrawal', 38),
  (48, '2020-01-25', 'withdrawal', 236),
  (48, '2020-01-23', 'purchase', 339),
  (48, '2020-01-14', 'purchase', 534),
  (48, '2020-02-15', 'withdrawal', 199),
  (48, '2020-03-17', 'deposit', 472),
  (425, '2020-03-04', 'deposit', 275),
  (425, '2020-03-08', 'deposit', 287),
  (425, '2020-02-21', 'purchase', 102),
  (425, '2020-02-14', 'deposit', 708),
  (425, '2020-04-07', 'purchase', 431),
  (425, '2020-04-04', 'withdrawal', 347),
  (425, '2020-02-21', 'deposit', 250),
  (425, '2020-02-16', 'purchase', 483),
  (425, '2020-02-18', 'deposit', 55),
  (425, '2020-02-20', 'withdrawal', 483),
  (425, '2020-02-29', 'purchase', 513),
  (425, '2020-01-15', 'purchase', 245),
  (422, '2020-03-08', 'deposit', 944),
  (422, '2020-03-14', 'purchase', 256),
  (422, '2020-02-02', 'purchase', 8),
  (422, '2020-03-02', 'purchase', 641),
  (422, '2020-04-07', 'withdrawal', 878),
  (422, '2020-04-20', 'purchase', 791),
  (422, '2020-04-11', 'deposit', 355),
  (422, '2020-03-24', 'deposit', 242),
  (422, '2020-02-29', 'deposit', 434),
  (422, '2020-03-22', 'purchase', 488),
  (422, '2020-02-08', 'withdrawal', 653),
  (422, '2020-02-07', 'deposit', 364),
  (422, '2020-04-06', 'purchase', 210),
  (422, '2020-02-08', 'withdrawal', 779),
  (422, '2020-04-11', 'purchase', 787),
  (422, '2020-02-28', 'deposit', 442),
  (422, '2020-02-13', 'purchase', 465),
  (422, '2020-02-04', 'purchase', 947),
  (422, '2020-03-02', 'deposit', 814),
  (422, '2020-02-29', 'purchase', 405),
  (493, '2020-02-20', 'withdrawal', 894),
  (493, '2020-04-07', 'deposit', 918),
  (493, '2020-02-29', 'withdrawal', 465),
  (493, '2020-02-14', 'deposit', 173),
  (493, '2020-04-12', 'withdrawal', 832),
  (493, '2020-02-14', 'withdrawal', 483),
  (457, '2020-02-26', 'withdrawal', 729),
  (457, '2020-03-18', 'deposit', 248),
  (457, '2020-03-30', 'purchase', 107),
  (457, '2020-03-13', 'deposit', 341),
  (457, '2020-02-12', 'deposit', 300),
  (457, '2020-03-20', 'purchase', 962),
  (457, '2020-04-19', 'purchase', 471),
  (457, '2020-04-13', 'deposit', 467),
  (457, '2020-01-24', 'withdrawal', 462),
  (179, '2020-01-13', 'deposit', 470),
  (179, '2020-02-15', 'withdrawal', 443),
  (179, '2020-01-14', 'purchase', 882),
  (179, '2020-03-05', 'purchase', 300),
  (179, '2020-03-11', 'withdrawal', 831),
  (179, '2020-03-19', 'purchase', 597),
  (179, '2020-01-26', 'withdrawal', 488),
  (179, '2020-03-17', 'withdrawal', 283),
  (179, '2020-02-09', 'purchase', 638),
  (179, '2020-02-05', 'withdrawal', 106),
  (179, '2020-02-01', 'purchase', 752),
  (179, '2020-03-31', 'withdrawal', 675),
  (179, '2020-03-20', 'deposit', 516),
  (179, '2020-03-14', 'purchase', 688),
  (179, '2020-03-05', 'withdrawal', 740),
  (179, '2020-01-28', 'withdrawal', 39),
  (179, '2020-01-11', 'purchase', 892),
  (179, '2020-02-10', 'purchase', 384),
  (179, '2020-02-15', 'deposit', 691),
  (179, '2020-01-26', 'deposit', 58),
  (179, '2020-03-27', 'purchase', 969),
  (41, '2020-04-25', 'withdrawal', 739),
  (41, '2020-03-23', 'deposit', 582),
  (41, '2020-03-26', 'purchase', 617),
  (41, '2020-02-02', 'deposit', 443),
  (41, '2020-03-12', 'deposit', 151),
  (41, '2020-03-27', 'deposit', 689),
  (41, '2020-02-06', 'deposit', 84),
  (41, '2020-03-22', 'deposit', 232),
  (41, '2020-03-25', 'deposit', 872),
  (41, '2020-03-26', 'deposit', 65),
  (41, '2020-03-15', 'purchase', 397),
  (41, '2020-03-12', 'purchase', 293),
  (41, '2020-01-31', 'withdrawal', 836),
  (41, '2020-03-05', 'deposit', 914),
  (41, '2020-02-23', 'deposit', 898),
  (41, '2020-03-30', 'purchase', 136),
  (41, '2020-04-04', 'withdrawal', 177),
  (39, '2020-04-09', 'withdrawal', 529),
  (39, '2020-02-19', 'withdrawal', 281),
  (39, '2020-04-17', 'deposit', 933),
  (39, '2020-03-27', 'withdrawal', 55),
  (39, '2020-02-15', 'deposit', 792),
  (39, '2020-01-22', 'deposit', 433),
  (39, '2020-03-25', 'withdrawal', 409),
  (39, '2020-04-09', 'deposit', 939),
  (39, '2020-04-13', 'withdrawal', 644),
  (39, '2020-02-27', 'purchase', 233),
  (39, '2020-02-10', 'deposit', 73),
  (39, '2020-02-01', 'deposit', 608),
  (39, '2020-04-08', 'withdrawal', 240),
  (39, '2020-03-04', 'deposit', 536),
  (39, '2020-04-04', 'purchase', 28),
  (39, '2020-04-01', 'purchase', 375),
  (235, '2020-03-16', 'deposit', 530),
  (235, '2020-02-06', 'deposit', 428),
  (235, '2020-02-22', 'deposit', 535),
  (235, '2020-01-22', 'purchase', 890),
  (235, '2020-02-25', 'deposit', 524),
  (235, '2020-03-20', 'withdrawal', 30),
  (235, '2020-01-31', 'purchase', 877),
  (235, '2020-01-10', 'purchase', 919),
  (203, '2020-01-09', 'purchase', 650),
  (203, '2020-01-25', 'deposit', 293),
  (203, '2020-03-07', 'purchase', 647),
  (203, '2020-02-26', 'purchase', 416),
  (203, '2020-03-27', 'deposit', 169),
  (203, '2020-03-31', 'purchase', 608),
  (203, '2020-02-29', 'deposit', 639),
  (203, '2020-03-29', 'deposit', 520),
  (203, '2020-02-17', 'deposit', 670),
  (203, '2020-01-20', 'deposit', 789),
  (203, '2020-01-18', 'deposit', 812),
  (203, '2020-02-27', 'purchase', 133),
  (203, '2020-03-16', 'deposit', 404),
  (203, '2020-03-14', 'deposit', 510),
  (203, '2020-01-29', 'purchase', 4),
  (203, '2020-04-04', 'withdrawal', 24),
  (203, '2020-02-21', 'withdrawal', 622),
  (203, '2020-01-08', 'deposit', 318),
  (203, '2020-03-10', 'purchase', 358),
  (203, '2020-02-05', 'withdrawal', 57),
  (203, '2020-02-07', 'deposit', 862),
  (119, '2020-04-10', 'deposit', 417),
  (119, '2020-03-09', 'withdrawal', 969),
  (233, '2020-02-08', 'deposit', 234),
  (233, '2020-02-28', 'purchase', 528),
  (233, '2020-02-14', 'deposit', 572),
  (233, '2020-03-01', 'deposit', 832),
  (233, '2020-01-08', 'deposit', 833),
  (233, '2020-02-12', 'deposit', 837),
  (233, '2020-01-21', 'purchase', 471),
  (233, '2020-01-23', 'deposit', 445),
  (233, '2020-01-17', 'deposit', 801),
  (451, '2020-04-06', 'withdrawal', 117),
  (451, '2020-04-09', 'withdrawal', 595),
  (451, '2020-02-28', 'withdrawal', 807),
  (451, '2020-02-06', 'purchase', 853),
  (451, '2020-03-13', 'deposit', 668),
  (451, '2020-04-19', 'deposit', 601),
  (451, '2020-02-19', 'withdrawal', 563),
  (392, '2020-02-07', 'deposit', 223),
  (392, '2020-03-04', 'purchase', 120),
  (392, '2020-04-01', 'withdrawal', 503),
  (392, '2020-04-12', 'purchase', 70),
  (392, '2020-03-09', 'withdrawal', 416),
  (392, '2020-02-06', 'deposit', 995),
  (392, '2020-01-29', 'withdrawal', 60),
  (392, '2020-04-21', 'deposit', 328),
  (491, '2020-02-24', 'deposit', 512),
  (491, '2020-01-19', 'withdrawal', 837),
  (491, '2020-03-12', 'deposit', 892),
  (491, '2020-02-07', 'deposit', 3),
  (491, '2020-02-09', 'deposit', 442),
  (491, '2020-03-04', 'withdrawal', 921),
  (491, '2020-03-08', 'purchase', 526),
  (491, '2020-03-18', 'withdrawal', 759),
  (491, '2020-03-04', 'withdrawal', 334),
  (491, '2020-01-27', 'deposit', 943),
  (491, '2020-03-28', 'purchase', 969),
  (491, '2020-01-30', 'purchase', 127),
  (491, '2020-02-11', 'withdrawal', 656),
  (393, '2020-03-05', 'deposit', 867),
  (393, '2020-04-04', 'withdrawal', 68),
  (393, '2020-03-29', 'withdrawal', 356),
  (393, '2020-03-29', 'deposit', 776),
  (393, '2020-02-04', 'withdrawal', 62),
  (393, '2020-02-08', 'deposit', 98),
  (393, '2020-02-01', 'purchase', 577),
  (393, '2020-03-17', 'withdrawal', 727),
  (393, '2020-03-25', 'purchase', 327),
  (393, '2020-04-05', 'purchase', 317),
  (393, '2020-03-21', 'deposit', 739),
  (393, '2020-01-30', 'deposit', 541),
  (393, '2020-03-01', 'deposit', 720),
  (393, '2020-04-10', 'purchase', 476),
  (393, '2020-03-02', 'withdrawal', 310),
  (115, '2020-02-01', 'purchase', 400),
  (115, '2020-03-03', 'deposit', 747),
  (115, '2020-03-07', 'deposit', 672),
  (115, '2020-04-06', 'deposit', 20),
  (115, '2020-02-08', 'withdrawal', 196),
  (115, '2020-03-30', 'deposit', 361),
  (115, '2020-02-25', 'purchase', 393),
  (115, '2020-03-28', 'purchase', 51),
  (115, '2020-04-06', 'withdrawal', 945),
  (150, '2020-02-19', 'purchase', 264),
  (150, '2020-01-05', 'withdrawal', 715),
  (150, '2020-03-24', 'withdrawal', 807),
  (150, '2020-02-03', 'deposit', 63),
  (150, '2020-04-01', 'withdrawal', 825),
  (150, '2020-02-28', 'deposit', 206),
  (150, '2020-03-20', 'deposit', 715),
  (150, '2020-02-09', 'purchase', 546),
  (150, '2020-01-15', 'withdrawal', 869),
  (150, '2020-02-12', 'purchase', 371),
  (150, '2020-01-18', 'withdrawal', 176),
  (150, '2020-01-22', 'deposit', 166),
  (150, '2020-01-27', 'deposit', 925),
  (275, '2020-04-13', 'deposit', 934),
  (275, '2020-03-28', 'purchase', 768),
  (275, '2020-03-19', 'withdrawal', 869),
  (275, '2020-03-25', 'purchase', 473),
  (275, '2020-04-07', 'withdrawal', 643),
  (275, '2020-04-22', 'withdrawal', 445),
  (275, '2020-04-11', 'purchase', 676),
  (275, '2020-02-27', 'withdrawal', 281),
  (275, '2020-03-02', 'deposit', 127),
  (275, '2020-03-14', 'deposit', 600),
  (275, '2020-02-16', 'withdrawal', 918),
  (275, '2020-04-09', 'withdrawal', 220),
  (275, '2020-03-05', 'deposit', 377),
  (275, '2020-02-10', 'purchase', 390),
  (275, '2020-02-24', 'deposit', 53),
  (275, '2020-03-06', 'deposit', 763),
  (275, '2020-03-01', 'withdrawal', 481),
  (275, '2020-03-30', 'withdrawal', 924),
  (275, '2020-04-23', 'deposit', 854),
  (438, '2020-03-08', 'withdrawal', 802),
  (438, '2020-02-01', 'purchase', 93),
  (438, '2020-01-31', 'deposit', 957),
  (438, '2020-02-12', 'withdrawal', 159),
  (438, '2020-02-26', 'deposit', 858),
  (438, '2020-01-20', 'withdrawal', 538),
  (438, '2020-03-07', 'deposit', 273),
  (438, '2020-02-13', 'deposit', 890),
  (438, '2020-01-12', 'deposit', 705),
  (438, '2020-01-13', 'withdrawal', 68),
  (438, '2020-03-25', 'purchase', 861),
  (153, '2020-03-23', 'deposit', 683),
  (153, '2020-03-27', 'purchase', 178),
  (153, '2020-01-26', 'withdrawal', 703),
  (153, '2020-02-07', 'deposit', 664),
  (153, '2020-03-31', 'purchase', 845),
  (153, '2020-03-10', 'deposit', 378),
  (153, '2020-02-01', 'purchase', 302),
  (153, '2020-02-24', 'deposit', 353),
  (153, '2020-02-20', 'deposit', 959),
  (153, '2020-02-25', 'withdrawal', 107),
  (153, '2020-02-15', 'deposit', 752),
  (153, '2020-01-22', 'purchase', 987),
  (153, '2020-02-06', 'withdrawal', 181),
  (153, '2020-02-08', 'purchase', 578),
  (153, '2020-03-21', 'purchase', 274),
  (153, '2020-01-22', 'withdrawal', 587),
  (153, '2020-01-23', 'withdrawal', 431),
  (153, '2020-02-26', 'purchase', 382),
  (153, '2020-03-07', 'purchase', 683),
  (316, '2020-02-25', 'purchase', 305),
  (316, '2020-02-17', 'purchase', 851),
  (316, '2020-03-12', 'purchase', 208),
  (316, '2020-02-06', 'purchase', 663),
  (316, '2020-02-27', 'purchase', 848),
  (316, '2020-03-09', 'deposit', 264),
  (316, '2020-03-31', 'purchase', 872),
  (349, '2020-03-10', 'withdrawal', 818),
  (349, '2020-02-08', 'deposit', 362),
  (349, '2020-02-01', 'deposit', 498),
  (349, '2020-01-18', 'purchase', 981),
  (349, '2020-02-26', 'withdrawal', 885),
  (349, '2020-04-14', 'deposit', 545),
  (349, '2020-03-02', 'deposit', 49),
  (349, '2020-02-15', 'purchase', 171),
  (349, '2020-03-27', 'deposit', 881),
  (349, '2020-01-31', 'withdrawal', 436),
  (349, '2020-04-03', 'deposit', 110),
  (349, '2020-03-28', 'deposit', 665),
  (349, '2020-03-03', 'deposit', 747),
  (349, '2020-03-20', 'deposit', 934),
  (349, '2020-03-27', 'withdrawal', 109),
  (77, '2020-03-07', 'deposit', 92),
  (77, '2020-02-19', 'deposit', 381),
  (77, '2020-03-08', 'withdrawal', 412),
  (77, '2020-03-01', 'deposit', 616),
  (474, '2020-02-08', 'withdrawal', 789),
  (474, '2020-03-08', 'withdrawal', 398),
  (224, '2020-02-22', 'purchase', 336),
  (224, '2020-03-26', 'deposit', 486),
  (224, '2020-04-04', 'deposit', 212),
  (224, '2020-03-28', 'purchase', 910),
  (224, '2020-03-12', 'withdrawal', 907),
  (224, '2020-02-14', 'purchase', 765),
  (224, '2020-02-13', 'purchase', 491),
  (224, '2020-02-20', 'deposit', 899),
  (224, '2020-03-31', 'withdrawal', 927),
  (224, '2020-03-13', 'deposit', 883),
  (214, '2020-02-21', 'withdrawal', 626),
  (214, '2020-01-20', 'deposit', 191),
  (214, '2020-01-21', 'purchase', 940),
  (214, '2020-01-31', 'purchase', 21),
  (214, '2020-03-04', 'deposit', 116),
  (214, '2020-02-22', 'withdrawal', 233),
  (214, '2020-02-23', 'deposit', 438),
  (214, '2020-04-10', 'deposit', 347),
  (214, '2020-03-02', 'deposit', 698),
  (214, '2020-04-06', 'purchase', 546),
  (214, '2020-03-05', 'deposit', 780),
  (214, '2020-02-12', 'withdrawal', 645),
  (214, '2020-04-07', 'deposit', 918),
  (254, '2020-03-31', 'deposit', 734),
  (254, '2020-02-02', 'purchase', 482),
  (254, '2020-02-23', 'purchase', 931),
  (254, '2020-03-27', 'deposit', 961),
  (254, '2020-03-14', 'withdrawal', 782),
  (254, '2020-02-08', 'withdrawal', 971),
  (254, '2020-03-28', 'deposit', 778),
  (254, '2020-01-27', 'purchase', 820),
  (254, '2020-03-18', 'deposit', 590),
  (254, '2020-03-29', 'deposit', 17),
  (254, '2020-02-10', 'withdrawal', 314),
  (254, '2020-02-27', 'purchase', 221),
  (254, '2020-03-30', 'purchase', 5),
  (189, '2020-01-12', 'deposit', 373),
  (189, '2020-03-17', 'purchase', 726),
  (189, '2020-03-18', 'withdrawal', 462),
  (189, '2020-01-30', 'purchase', 956),
  (189, '2020-02-03', 'withdrawal', 870),
  (189, '2020-03-22', 'purchase', 718),
  (189, '2020-02-06', 'purchase', 393),
  (189, '2020-01-22', 'deposit', 302),
  (189, '2020-01-27', 'withdrawal', 861);

----------------------------------------------------------------------------------------
-- Truy van
-- A. Customer Nodes Exploration
-- 1. How many unique nodes are there on the Data Bank system?

select count(distinct node_id) as num_node
from customer_nodes;

-- 2. What is the number of nodes per region?

select region_id, count(distinct node_id) as num_node_per_region
from customer_nodes
group by region_id;

-- 3. How many customers are allocated to each region?
---- phan tich phan bo khach hang: khu vuc nao nhieu k.hang nhat,...
---- ngoai ra con co the phan tich phat trien theo vung...
---- tu do dua ra chien luoc phan bo va quan ly vung hieu qua

select region_id, count(distinct customer_id) as num_cus_per_region
from customer_nodes
group by region_id
order by region_id;

-- 4. How many days on average are customers reallocated to a different node?

with ordered_nodes as( 
     select customer_id, node_id, start_date, end_date,
	        lead(start_date) over (partition by customer_id order by start_date) as next_start_date,
			lead(node_id) over (partition by customer_id order by start_date) as next_node_id
	 from customer_nodes
),

joined_allocations as(
     select customer_id,
			datediff(day, end_date, next_start_date) as days_between
	 from ordered_nodes
	 where node_id <> next_node_id
)

select avg(days_between * 1.0) as avg_days_change_node
from joined_allocations;	

-- 5. What is the median, 80th and 95th percentile for this same reallocation days metric for each region?
---- giup hieu ro xu huong va phan bo thoi gian chuyen node cua khach hang o tung vung

with ordered_nodes as( 
     select customer_id, region_id, node_id, start_date, end_date,
	        lead(start_date) over (partition by customer_id order by start_date) as next_start_date,
			lead(node_id) over (partition by customer_id order by start_date) as next_node_id
	 from customer_nodes
),

joined_allocations as(
     select customer_id, region_id,
			datediff(day, end_date, next_start_date) as days_between
	 from ordered_nodes
	 where node_id <> next_node_id
),

percentile_data as(
     select region_id, 
            PERCENTILE_CONT(0.5) within group (order by days_between) over (partition by region_id) as med_days,
	        PERCENTILE_CONT(0.8) within group (order by days_between) over (partition by region_id) as p80_days,
	        PERCENTILE_CONT(0.95) within group (order by days_between) over (partition by region_id) as p95_days
     from joined_allocations
)

select distinct region_id, med_days, p80_days, p95_days
from percentile_data
order by region_id;


-- B. Customer Transactions
-- 1. What is the unique count and total amount for each transaction type?
---- giup doi ngu xac dinh so luong khach hang su dung tung loai dv
---- hay noi cach khac la hieu ro muc do pho bien va gia tri cua tung loai giao dich trong ht

select txn_type, count(distinct customer_id) as count_unique_cus, sum(txn_amount) as total_amount
from customer_transactions
group by txn_type;

-- 2. What is the average total historical deposit counts and amounts for all customers?
---- xac dinh/danh gia muc do sd dich vu cua khach hang
---- lam co so de phan nhom khach hang
---- co the dua ra du bao dong tien trong tuong lai

with deposit_summary as (
     select customer_id, count(*) as count_deposit, 
	        sum(txn_amount) as total_amount_deposit
	 from customer_transactions
	 where txn_type = 'deposit'
	 group by customer_id
)

select cast(round(avg(count_deposit * 1.0), 2) as decimal(10, 2)) as avg_deposit_count,
       cast(round(avg(total_amount_deposit * 1.0), 2) as decimal(10, 2)) as avg_deposit_amount
from deposit_summary;

-- 3. For each month - how many Data Bank customers make more than 1 deposit and either 1 purchase or 1 withdrawal in a single month?
----giup xac dinh xu huong, hanh vi nguoi dung
---- phan khuc nguoi dung

with trans_summary1 as (
      select customer_id, 
	         format(txn_date, 'yyyy-MM') as month,
			 txn_type,
	         count(*) as txn_count
	  from customer_transactions
	  group by customer_id, 
	           format(txn_date, 'yyyy-MM'),
			   txn_type
),

trans_summary2 as(
     select customer_id,
	        month,
			max(case when txn_type = 'deposit' then txn_count else 0 end) as count_deposit,
			max(case when txn_type = 'purchase' then txn_count else 0 end) as count_purchase,
			max(case when txn_type = 'withdrawal' then txn_count else 0 end) as count_withdrawal
	 from trans_summary1
	 group by customer_id, 
	          month
)

select month, count(distinct customer_id) as num_cus
from trans_summary2
where count_deposit > 1 and (count_purchase >= 1 or count_withdrawal >= 1)
group by month
order by month;

-- 4. What is the closing balance for each customer at the end of the month?
---- giup doi ngu theo doi bien dong tai chinh cua moi ca nhan khach hang
---- giup phan tich hanh vi nguoi dung
---- xac dinh khach hang tiem nang
---- dua ra canh bao rui ro  

with monthly_balance as (
     select customer_id, 
        format(txn_date, 'yyyy-MM') as month,
	    sum(case when txn_type = 'deposit' then txn_amount else 0 end) 
	    - sum(case when txn_type = 'purchase' or txn_type = 'withdrawal' then txn_amount else 0 end) as net_change
     from customer_transactions
     group by customer_id, 
              format(txn_date, 'yyyy-MM')
)
select customer_id,
       month,
	   sum(net_change) over (partition by customer_id order by customer_id, month rows unbounded preceding) as closing_balance
from monthly_balance;


-- 5. What is the percentage of customers who increase their closing balance by more than 5%?
---- giup doi ngu co the danh gia xu huong tic luy tien cua khach hang, ho tro phan khuc khach hang
---- hoac xac dinh nhom khach hang tiem nang

declare @total_cus int;
select @total_cus = count(distinct customer_id) from customer_transactions;

with monthly_balance as (
     select customer_id, 
        format(txn_date, 'yyyy-MM') as month,
	    sum(case when txn_type = 'deposit' then txn_amount else 0 end) 
	    - sum(case when txn_type = 'purchase' or txn_type = 'withdrawal' then txn_amount else 0 end) as net_change
     from customer_transactions
     group by customer_id, 
              format(txn_date, 'yyyy-MM')
),

closing_balance as(
    select customer_id,
           month,
	       sum(net_change) over (partition by customer_id order by customer_id, month rows unbounded preceding) as closing_balance
    from monthly_balance
),

growth_calc as(
    select customer_id,
	       month,
		   closing_balance,
		   lag(closing_balance) over (partition by customer_id order by month) as prev_closing_balance
	from closing_balance
),

growth_mark as (
    select customer_id,
	       month,
		   closing_balance,
		   prev_closing_balance,
		   case
		       when prev_closing_balance > 0
			        and (closing_balance - prev_closing_balance)*1.0 / prev_closing_balance > 0.05
					then 1 else 0
				end as increased_over_5_percentage
	 from growth_calc 
),

cus_increase as (
    select distinct customer_id
	from growth_mark
	where increased_over_5_percentage = 1
)

select cast(round(count(*) * 100.0 / @total_cus, 2) as decimal(10, 2)) as percent_cus_increase
from cus_increase;

